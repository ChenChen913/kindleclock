name: DeepSeek Code Assistant
on:
  issue_comment:
    types: [created]

jobs:
  deepseek_edit:
    # åªæœ‰å½“è¯„è®ºåŒ…å« /bot update æ—¶æ‰è¿è¡Œï¼Œçœé’±çœèµ„æº
    if: contains(github.event.comment.body, '/bot update')
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
      issues: write

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: pip install openai PyGithub

      - name: Run AI Bot
        env:
          DEEPSEEK_API_KEY: ${{ secrets.DEEPSEEK_API_KEY }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          COMMENT_BODY: ${{ github.event.comment.body }}
        run: python .github/scripts/ai_bot.py

      - name: Commit and Push changes
        run: |
          git config --global user.name "DeepSeek Bot"
          git config --global user.email "bot@deepseek.com"
          
          # æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶å˜åŠ¨
          if [[ -n $(git status -s) ]]; then
            git add .
            git commit -m "ğŸ¤– DeepSeek AI æ ¹æ®è¯„è®ºè‡ªåŠ¨ä¿®æ”¹ä»£ç "
            git push
            echo "âœ… ä»£ç å·²æ¨é€åˆ°å½“å‰åˆ†æ”¯"
          else
            echo "æ²¡æœ‰æ£€æµ‹åˆ°æ–‡ä»¶å˜åŠ¨"
          fi
